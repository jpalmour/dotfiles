#!/usr/bin/env bash
set -euo pipefail

echo " bootstrap starting..."

# --- Base CLI tools
echo " installing base CLI tools..."
brew install \
  git \
  curl \
  wget \
  vim \
  tmux \
  tree \
  jq \
  ripgrep \
  coreutils \
  gnu-sed \
  make \
  gh

# --- SSH Server setup ---
echo " enabling SSH server (Remote Login)..."
sudo systemsetup -setremotelogin on

# --- Zsh ---
if ! command -v zsh >/dev/null 2>&1; then
  echo " installing zsh..."
  brew install zsh
fi
# Make zsh default shell
if [ "$SHELL" != "$(command -v zsh)" ]; then
  echo " setting default shell to zsh..."
  chsh -s "$(command -v zsh)"
fi

# --- GUI apps (brew cask) matching your Ubuntu list ---
echo " installing GUI apps (casks)..."
brew install --cask \
  visual-studio-code \
  google-chrome \
  slack \
  1password \
  docker \
  ghostty

# --- Developer/AI tools ---
echo " installing developer/AI tools..."

# nvm (via brew, simpler than curl script here)
if ! command -v nvm >/dev/null 2>&1; then
  brew install nvm
  mkdir -p ~/.nvm
  grep -q 'NVM_DIR' ~/.zprofile 2>/dev/null || cat >> ~/.zprofile <<'EOF'

# nvm setup (added by chezmoi bootstrap)
export NVM_DIR="$HOME/.nvm"
[ -s "$(brew --prefix nvm)/nvm.sh" ] && \. "$(brew --prefix nvm)/nvm.sh"
EOF
fi

echo " bootstrap done âœ…"

