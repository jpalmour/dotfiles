{{- if lookPath "op" }}
{{- $sshItem := onepasswordItemFields "Dev SSH Key" -}}
{{- $pub := index $sshItem "Public Key" -}}
{{- if not $pub }}{{ fail "❌ Could not read 'Public Key' field from 1Password item 'Dev SSH Key'.\n\n📚 Please follow the setup instructions in 1PASS_SETUP.md to create this item:\n   1. Run: op item create --category \"SSH Key\" --title \"Dev SSH Key\" --generate-password=\"ed25519\" --ssh-generate-key=\"ed25519:your-email@example.com\"\n   2. Add the public key to GitHub for both authentication and signing\n   3. Run 'chezmoi apply' again\n\n🔍 To verify the item exists: op item get \"Dev SSH Key\" --fields \"public key\"" }}{{ end }}
{{ $pub }}
{{- else }}
# 1Password CLI not yet installed - authorized keys will be configured after setup
{{- end }}
