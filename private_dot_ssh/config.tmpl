Host *
  ServerAliveInterval 60
  ServerAliveCountMax 2
{{- if eq .chezmoi.os "darwin" }}
  UseKeychain yes
  IdentityAgent ~/.1password/agent.sock
{{- else if eq .chezmoi.os "linux" }}
  IdentityAgent ~/.1password/agent.sock
{{- end }}

# --- GitHub hosts (only on work machines) ---

{{- if .is_work_machine }}
Host github.com
  HostName github.com
  User git
  IdentitiesOnly yes
  {{- if not .is_wsl }}
  IdentityFile ~/.ssh/id_ed25519_work
  {{- end }}

Host github-personal.com
  HostName github.com
  User git
  IdentitiesOnly yes
  {{- if not .is_wsl }}
  IdentityFile ~/.ssh/id_ed25519_dev
  {{- end }}
{{- end }}

# --- Private host blocks from 1Password ---

{{- if or (and .is_wsl (lookPath "op.exe")) (and (not .is_wsl) (lookPath "op")) }}
{{-   if .is_wsl -}}
{{ output "op.exe" "read" "op://Private/ssh-hosts/hosts" }}
{{-   else -}}
{{ onepasswordRead "op://Private/ssh-hosts/hosts" }}
{{-   end -}}
{{- else }}
# 1Password CLI not installed - host configs will be added after 1Password is configured
{{- end }}
